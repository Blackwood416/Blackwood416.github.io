---
title: 随身WiFi折腾日志 01
date: 2024-10-19 00:42:45
tags: 随身WiFi
categories: 搞机
---

## 前言

本系列博客将记录我折腾一根MSM8916（骁龙410）芯片的随身WiFi的过程。

## 材料准备

- 一根MSM8916（骁龙410）芯片的随身WiFi
- 一根USB延长线（用来连接电脑）
- 尖头的镊子（用来短接主板触电）（可选）
- 小型十字螺丝刀（用来拧螺丝）

## 软件工具

我不喜欢使用别人封装的某某工具箱，所以我使用了官方的固件烧写工具QPT（Qualcomm Premium Tool）。

网上就能下载到，不过还需要key来激活。

## 进入9008模式

首先，我们需要进入9008模式。

进入9008模式有两种方式：

1. 在插上电源的同时按住主板上的重置键（RESET）
2. 短接主板上的特定触点（根据主板型号而定）

我手上的这根番茄朵扬的随身wifi（主板型号：SP970）第一种方式无效，所以我使用的是第二种方式。

如果你成功进入9008模式，那么你的随身wifi并不会有正常开机的led灯闪烁，并且你能在**设备管理器**的端口里找到9008设备，如下图所示：

TODO：待补充

如果你找不到设备，那么可能是你没有安装9008驱动。

## 备份

在刷入固件之前，建议备份好原有的数据。QPT的备份分三种：Block0、Partition、Firmware，我们都需要用到。

- Block0：俗称全量包备份，包含了磁盘中的所有数据，建议首先备份，只会导出一个.bin文件。

- Partition：可以以分区的形式备份所有的分区，每个分区都会导出一个.img或.bin文件。

- Firmware：用于备份系统的固件分区，会导出很多文件以及rawprogram0.xml分区配置表，同时userdata分区是不会进行备份的。

> Tips：每次进入9008模式，只能进行一次scan（扫描）或者read（读取）操作，所以我们可能需要数次进入9008模式才能完成三种备份。

### Block0备份

我们一定要首先进行Block0备份，否则一旦刷机过程出错，我们就无法恢复到最开始的状态以便重新开始了。

进入9008模式，打开QPT，选择Block0选项卡，选择备份文件夹，点击**Read( 9008 )**，等待备份完成。

### Partition备份

进入9008模式，打开QPT，选择partition选项卡，选择scan后点击红色的**DoJob**，待读取出全部分区后，选择右侧的**Backup All**，选择备份文件夹，等待备份完成。

### Firmware备份

进入9008模式，打开QPT，选择Firmware选项卡，选择**backup Firmware**，选择备份文件夹，等待备份完成。

> Tips：中途可能提示失败，可能是因为读到了userdata分区导致的，并不妨碍我们备份固件，无视即可。

## 刷入系统

我们从[这里](https://www.kancloud.cn/a813630449/ufi_car/2795165)下载大佬编译的Debian系统，在下载页面选择对应主板号的版本下载下来。

1. 下载好后，解压到一个文件夹。
2. TODO：待补充
3. 打开QPT，在Partition页面对boot分区进行format操作，再将随身wifi拔插一下，即可重启到fastboot模式。
4. 打开命令行，cd到Debian系统的解压目录，输入命令：

```bat
fastboot devices # 查看设备是否连接成功
.\flash.bat # 开始刷入系统
```

途中需要按几次回车，等待刷入完成，拔插一次随身wifi，即可进入系统，此时会发现随身wifi的led灯会变成蓝红色闪烁。

## 连接系统

我们需要通过ssh连接到系统，但在此之前，我们需要让windows系统识别到此时的随身wifi。

打开**设备管理器**，如果你在**其他设备**看到了**未知的RNDIS设备**，就说明系统识别到了随身wifi，但还需要安装驱动，否则无法连接。

> 如果你没看到，那么你需要查看设备管理器列表的顶部，看看你的随身wifi是否被识别为了ADB设备，如果是，那么你需要卸载那个设备并删除它的驱动。

直接选择从本地找驱动安装，找到**Microsoft**下的**远程NDIS设备**，点击安装。

安装完成后，就可以在网络适配器list中看到**RNDIS设备**了。

然后，我们就可以通过ssh连接到系统了。

```bat
ssh root@192.168.68.1 # 192.168.68.1是这个debian系统默认的IP地址
# 输入密码1，即可进入系统
```

## 配置系统